@using MudBlazor
@inject NavigationManager NavManager

<div class="d-none d-lg-block">
    <MudButtonGroup Size="Size.Small" Variant="Variant.Outlined" Class="process-nav">
        @foreach (var step in Steps)
        {
            <MudButton Href="@step.Href"
                       Style="@(CurrentStep == step.Key ? "background-color: #4cc2e6; color: #000; font-weight:600;" : "")"
                       Variant="@(CurrentStep == step.Key ? Variant.Filled : Variant.Outlined)">
                <MudIcon Icon="@step.Icon" Size="Size.Small" Class="me-1" />
                @step.Text
            </MudButton>
        }
    </MudButtonGroup>
</div>

<div class="d-block d-lg-none ">
    <MudSelect T="string"
               Label="Step selection"
               Value="@CurrentStep"
               ValueChanged="NavigateToStep"
               Variant="Variant.Outlined"
               FullWidth="true"
               AdornmentIcon="@Icons.Material.Filled.Menu"
               AdornmentColor="Color.Primary">

        @foreach (var step in Steps)
        {
            <MudSelectItem Value="@step.Key">

                @* ğŸ‘ˆ ØªØºÛŒÛŒØ± Ø§ØµÙ„ÛŒ Ø§ÛŒÙ†Ø¬Ø§Ø³Øª: Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² div Ø¨Ø§ Ú©Ù„Ø§Ø³ d-flex Ùˆ align-center *@
                <div class="d-flex align-center">
                    <MudIcon Icon="@step.Icon" Size="Size.Small" Class="me-2" />
                    <span>@step.Text</span>

                    @* Ø¢ÛŒÚ©ÙˆÙ† ØªÛŒÚ© Ø¨Ø§ÛŒØ¯ Ø¨Ù‡ Ø§Ù†ØªÙ‡Ø§ÛŒ Ø±Ø¯ÛŒÙ ÙÙ„Ú©Ø³ Ø¨Ø±ÙˆØ¯ (Ø¨Ø§ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² ms-auto) *@
                    @if (CurrentStep == step.Key)
                    {
                        <MudIcon Icon="@Icons.Material.Filled.Check" Size="Size.Small" Class="ms-auto" Color="Color.Success" />
                    }
                </div>
            </MudSelectItem>
        }
    </MudSelect>
</div>

@code {
   
    [Parameter]
    public string CurrentStep { get; set; } = "weight";

    // ØªØ¹Ø±ÛŒÙ Ø³Ø§Ø®ØªØ§Ø± Ø¯Ø§Ø¯Ù‡â€ŒØ§ÛŒ Ù…Ø±Ø§Ø­Ù„ Ø¨Ø±Ø§ÛŒ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø¯Ø± Ù‡Ø± Ø¯Ùˆ Ø­Ø§Ù„Øª (Ø¯Ø³Ú©ØªØ§Ù¾ Ùˆ Ù…ÙˆØ¨Ø§ÛŒÙ„)
    private readonly List<(string Key, string Text, string Icon, string Href)> Steps = new()
    {
        ("weight", "Weight", Icons.Material.Filled.FitnessCenter, "/process/weight"),
        ("volume", "Volume", Icons.Material.Filled.Water, "/process/volume"),
        ("df", "DF", Icons.Material.Filled.Compress, "/process/df"),
        ("empty", "Empty", Icons.Material.Filled.RemoveCircleOutline, "/process/empty"),
        ("crm", "CRM", Icons.Material.Filled.Verified, "/process/crm"),
        ("drift", "Drift", Icons.Material.Filled.TrendingUp, "/process/drift"),
        ("result", "Result", Icons.Material.Filled.CheckCircle, "/process/result")
    };

    /// <summary>
    /// Ù…ØªØ¯ÛŒ Ø¨Ø±Ø§ÛŒ Ù…Ø¯ÛŒØ±ÛŒØª ØªØºÛŒÛŒØ± Ù…Ù‚Ø¯Ø§Ø± Ø¯Ø± MudSelect Ùˆ Ø§Ù†Ø¬Ø§Ù… Ù…Ø³ÛŒØ±ÛŒØ§Ø¨ÛŒ
    /// </summary>
    private void NavigateToStep(string selectedStepKey)
    {
        // Ø§Ø·Ù…ÛŒÙ†Ø§Ù† Ø§Ø² Ø§ÛŒÙ†Ú©Ù‡ Ù…Ø³ÛŒØ±ÛŒØ§Ø¨ÛŒ ÙÙ‚Ø· Ø¯Ø± ØµÙˆØ±Øª ØªØºÛŒÛŒØ± Ù…Ø±Ø­Ù„Ù‡ Ø§Ù†Ø¬Ø§Ù… Ø´ÙˆØ¯
        if (CurrentStep != selectedStepKey)
        {
            var step = Steps.FirstOrDefault(s => s.Key == selectedStepKey);
            if (step.Key != null)
            {
                NavManager.NavigateTo(step.Href);
            }
        }
    }
}